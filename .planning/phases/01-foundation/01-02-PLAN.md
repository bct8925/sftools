---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified: [src/lib/icons.js]
autonomous: true
---

<objective>
Replace manual SVG definitions in src/lib/icons.js with SLDS icon imports using Vite's ?raw suffix.

Purpose: Create a tree-shakeable icon utility that imports only the icons actually used.
Output: Updated icons.js with SLDS imports, same API surface (icons object + replaceIcons function).
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-01-SUMMARY.md

@src/lib/icons.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Map current icons to SLDS equivalents</name>
  <files>src/lib/icons.js</files>
  <action>
Map each current icon to its SLDS utility equivalent:

Current icons:
- hamburger → rows (or filterList if rows unavailable)
- close → close
- closeLarge → close (rendered at larger size)
- verticalDots → threedots_vertical
- edit → edit
- refresh → refresh
- refreshSmall → refresh (rendered at smaller size)
- trash → delete
- refreshTab → refresh (rendered at 14px)
- closeTab → close (rendered at 14px)

Use the import path pattern from 01-01-SUMMARY.md. Expected format:
`import closeIcon from '@salesforce-ux/icons/dist/svg/utility/close.svg?raw';`

If an exact match isn't available, find the closest SLDS utility icon. Browse the utility folder to verify icon availability.
  </action>
  <verify>All current icon names have identified SLDS equivalents</verify>
  <done>Icon mapping complete with verified SLDS icon names</done>
</task>

<task type="auto">
  <name>Task 2: Rewrite icons.js with SLDS imports</name>
  <files>src/lib/icons.js</files>
  <action>
Replace the entire icons.js file with SLDS imports. Maintain the same exports:
- `replaceIcons(html)` function - unchanged behavior
- `icons` object - same keys, but values from SLDS imports

Structure:
```javascript
// Import SLDS icons as raw SVG strings
import closeIcon from '@salesforce-ux/icons/dist/svg/utility/close.svg?raw';
import refreshIcon from '@salesforce-ux/icons/dist/svg/utility/refresh.svg?raw';
// ... etc

// Helper to process raw SVG for consistent rendering
function processSvg(svg, { size = 16, fill = 'currentColor' } = {}) {
    return svg
        .replace(/width="[^"]*"/, `width="${size}"`)
        .replace(/height="[^"]*"/, `height="${size}"`)
        .replace(/fill="[^"]*"/g, `fill="${fill}"`);
}

export function replaceIcons(html) {
    return html.replace(/\{\{icon:(\w+)\}\}/g, (match, iconName) => {
        return icons[iconName] || match;
    });
}

export const icons = {
    hamburger: processSvg(rowsIcon, { size: 20 }),
    close: processSvg(closeIcon, { size: 16 }),
    closeLarge: processSvg(closeIcon, { size: 20 }),
    // ... etc
};
```

Key points:
- Use `fill="currentColor"` to inherit text color (match existing behavior)
- Apply size via the processSvg helper to maintain existing size variants
- Keep the exact same icon keys so existing code continues to work
  </action>
  <verify>
- File imports from @salesforce-ux/icons
- All existing icon keys preserved
- npm run build succeeds without errors
  </verify>
  <done>icons.js rewritten with SLDS imports, build passes</done>
</task>

<task type="auto">
  <name>Task 3: Verify build and basic rendering</name>
  <files>none (verification only)</files>
  <action>
Run build and verify icons work:

1. Run `npm run build` - should succeed without errors
2. Check dist/ output for icon SVGs in the bundle
3. Load extension in Chrome and verify:
   - App header hamburger menu icon renders
   - Close button icons render
   - Settings tab edit/refresh/trash icons render

If any icons don't render:
- Check console for import errors
- Verify path is correct
- Ensure processSvg preserves SVG structure
  </action>
  <verify>
- npm run build succeeds
- No console errors about missing icons
- At least 3 different icon types visually render correctly
  </verify>
  <done>Build passes, icons render in browser</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds
- [ ] icons.js uses SLDS imports (no manual SVG path definitions)
- [ ] All existing icon keys preserved (hamburger, close, closeLarge, verticalDots, edit, refresh, refreshSmall, trash, refreshTab, closeTab)
- [ ] Icons render correctly in browser
</verification>

<success_criteria>
- icons.js rewritten with @salesforce-ux/icons imports
- Same API surface maintained (icons object + replaceIcons function)
- Build succeeds
- Icons visually render in the extension
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md` with:
- Final icon mapping (current name → SLDS icon)
- Any icons that needed alternatives
- Build output observations (bundle size comparison if notable)
- Visual verification status
</output>
